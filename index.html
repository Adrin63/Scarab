<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="./style.css">
    <link href="./ConstructionKnight.ico" rel="shortcut icon">
    <link href="./ConstructionKnight.ico" rel="icon">
    <script type="text/javascript" src="actions.js"></script>
    <title>Scarab+</title>
  </head>
    <body>
      <img src="./HKMBanner.png" alt="HKM Banner" class="center">
      <h1 class="center, centertext">
        Thank you for using Scarab+ !!
      </h1>
      <p class="center, centertext" id="download-message">
        To download Scarab+, please download it from the <a href="https://github.com/TheMulhima/Scarab/releases/latest">releases page</a>
      </p>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.1/markdown-it.min.js" integrity="sha512-SYfDUYPg5xspsG6OOpXU366G8SZsdHOhqk/icdrYJ2E/WKZxPxze7d2HD3AyXpT7U22PZ5y74xRpqZ6A2bJ+kQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

      <script type="text/javascript">

        var req = new Request("https://raw.githubusercontent.com/TheMulhima/Scarab/master/README.md");
        fetch(req)
        .then(response => response.text())
        .then(data => {
          var releaseNotes = data.slice(184); //remove header, and badges

          var releaseNotesHeader = document.createElement("h2");
          releaseNotesHeader.innerHTML = "Readme: ";
          releaseNotesHeader.className = "center, centertext";
          releaseNotesHeader.setAttribute("style", "margin-top:20px");
          document.body.appendChild(releaseNotesHeader);

          var releaseNotesBody = document.createElement("zero-md");
          releaseNotesBody.className = "center";
          var md = window.markdownit();
          releaseNotesBody.innerHTML = md.render(releaseNotes);
          document.body.appendChild(releaseNotesBody);
        });


        if (getParam("download") !== null)
        {
          document.getElementById("download-message").innerHTML = "If nothing has be downloaded, please download it from the <a href=\"https://github.com/TheMulhima/Scarab/releases/latest\">releases page</a>";
          var userAgent = window.navigator.userAgent,
          platform = window.navigator?.userAgentData?.platform || window.navigator.platform,
          macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K', 'AppleWebKit'],
          windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'],
          iosPlatforms = ['iPhone', 'iPad', 'iPod'],
          link = null;

          if (macosPlatforms.indexOf(platform) !== -1)          link = "https://github.com/TheMulhima/Scarab/releases/latest/download/Scarab-MacOS.zip";
          else if (iosPlatforms.indexOf(platform) !== -1)       link = null
          else if (windowsPlatforms.indexOf(platform) !== -1)   link = "https://github.com/TheMulhima/Scarab/releases/latest/download/Scarab-Windows.zip";
          else if (/Android/.test(userAgent))                   link = null
          else if (/Linux/.test(platform))                      link = "https://github.com/TheMulhima/Scarab/releases/latest/download/Scarab-Linux.zip"

          if (link !== null) {
            openLink(link);
          }
          else {
            // make it feel like its loading
            setTimeout(function() {
              if (confirm("The website could not automatically detect your platform, would you like to open the releases page? You can download Scarab+ from there.")) {
                window.location.replace("https://github.com/TheMulhima/Scarab/releases/latest")
              }
            }, 500);
          }
        }
      </script>
    </body>
</html>